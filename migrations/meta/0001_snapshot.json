{
  "id": "cabb2fab-c7ed-43b5-8583-384425ab848f",
  "prevId": "dea0d4cf-c96d-4390-bfa3-df692655800f",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.alert_history": {
      "name": "alert_history",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "triggered_deal_id": {
          "name": "triggered_deal_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "alert_type": {
          "name": "alert_type",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": true
        },
        "sent_at": {
          "name": "sent_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "status": {
          "name": "status",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false,
          "default": "'sent'"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "alert_history_user_id_users_id_fk": {
          "name": "alert_history_user_id_users_id_fk",
          "tableFrom": "alert_history",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "alert_history_triggered_deal_id_triggered_deals_id_fk": {
          "name": "alert_history_triggered_deal_id_triggered_deals_id_fk",
          "tableFrom": "alert_history",
          "tableTo": "triggered_deals",
          "columnsFrom": [
            "triggered_deal_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.alert_preferences": {
      "name": "alert_preferences",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "team_id": {
          "name": "team_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "restaurant_id": {
          "name": "restaurant_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "email_alerts": {
          "name": "email_alerts",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "sms_alerts": {
          "name": "sms_alerts",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "alert_timing": {
          "name": "alert_timing",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'immediate'"
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        }
      },
      "indexes": {},
      "foreignKeys": {
        "alert_preferences_user_id_users_id_fk": {
          "name": "alert_preferences_user_id_users_id_fk",
          "tableFrom": "alert_preferences",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "alert_preferences_team_id_teams_id_fk": {
          "name": "alert_preferences_team_id_teams_id_fk",
          "tableFrom": "alert_preferences",
          "tableTo": "teams",
          "columnsFrom": [
            "team_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "alert_preferences_restaurant_id_restaurants_id_fk": {
          "name": "alert_preferences_restaurant_id_restaurants_id_fk",
          "tableFrom": "alert_preferences",
          "tableTo": "restaurants",
          "columnsFrom": [
            "restaurant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.deal_pages": {
      "name": "deal_pages",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "slug": {
          "name": "slug",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "title": {
          "name": "title",
          "type": "varchar(300)",
          "primaryKey": false,
          "notNull": true
        },
        "restaurant": {
          "name": "restaurant",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "offer_description": {
          "name": "offer_description",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "trigger_condition": {
          "name": "trigger_condition",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "deal_value": {
          "name": "deal_value",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "promo_code": {
          "name": "promo_code",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "instructions": {
          "name": "instructions",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "terms": {
          "name": "terms",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "valid_from": {
          "name": "valid_from",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "valid_until": {
          "name": "valid_until",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "source_url": {
          "name": "source_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "image_url": {
          "name": "image_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "discovered_site_id": {
          "name": "discovered_site_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "deal_pages_discovered_site_id_discovered_sites_id_fk": {
          "name": "deal_pages_discovered_site_id_discovered_sites_id_fk",
          "tableFrom": "deal_pages",
          "tableTo": "discovered_sites",
          "columnsFrom": [
            "discovered_site_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "deal_pages_slug_unique": {
          "name": "deal_pages_slug_unique",
          "nullsNotDistinct": false,
          "columns": [
            "slug"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.device_tokens": {
      "name": "device_tokens",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "varchar",
          "primaryKey": false,
          "notNull": true
        },
        "device_token": {
          "name": "device_token",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "platform": {
          "name": "platform",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": true
        },
        "device_info": {
          "name": "device_info",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "last_used": {
          "name": "last_used",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_device_tokens_user": {
          "name": "idx_device_tokens_user",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_device_tokens_active": {
          "name": "idx_device_tokens_active",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_device_tokens_platform": {
          "name": "idx_device_tokens_platform",
          "columns": [
            {
              "expression": "platform",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "device_tokens_user_id_users_id_fk": {
          "name": "device_tokens_user_id_users_id_fk",
          "tableFrom": "device_tokens",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "device_tokens_device_token_unique": {
          "name": "device_tokens_device_token_unique",
          "nullsNotDistinct": false,
          "columns": [
            "device_token"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.discovered_sites": {
      "name": "discovered_sites",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "url": {
          "name": "url",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "source_id": {
          "name": "source_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "search_term_id": {
          "name": "search_term_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "content": {
          "name": "content",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "raw_data": {
          "name": "raw_data",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "found_at": {
          "name": "found_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "confidence": {
          "name": "confidence",
          "type": "numeric(3, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "deal_extracted": {
          "name": "deal_extracted",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "restaurant_detected": {
          "name": "restaurant_detected",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "team_detected": {
          "name": "team_detected",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "trigger_detected": {
          "name": "trigger_detected",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": false
        },
        "promo_code_detected": {
          "name": "promo_code_detected",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "image_extracted": {
          "name": "image_extracted",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "expiration_detected": {
          "name": "expiration_detected",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "reviewed_at": {
          "name": "reviewed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "reviewed_by": {
          "name": "reviewed_by",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "discovered_sites_source_id_discovery_sources_id_fk": {
          "name": "discovered_sites_source_id_discovery_sources_id_fk",
          "tableFrom": "discovered_sites",
          "tableTo": "discovery_sources",
          "columnsFrom": [
            "source_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "discovered_sites_search_term_id_search_terms_id_fk": {
          "name": "discovered_sites_search_term_id_search_terms_id_fk",
          "tableFrom": "discovered_sites",
          "tableTo": "search_terms",
          "columnsFrom": [
            "search_term_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "discovered_sites_reviewed_by_users_id_fk": {
          "name": "discovered_sites_reviewed_by_users_id_fk",
          "tableFrom": "discovered_sites",
          "tableTo": "users",
          "columnsFrom": [
            "reviewed_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.discovery_sources": {
      "name": "discovery_sources",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "type": {
          "name": "type",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": true
        },
        "base_url": {
          "name": "base_url",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "search_endpoint": {
          "name": "search_endpoint",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": false
        },
        "api_key": {
          "name": "api_key",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "priority": {
          "name": "priority",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 5
        },
        "rate_limit": {
          "name": "rate_limit",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 100
        },
        "last_checked": {
          "name": "last_checked",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "success_count": {
          "name": "success_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "error_count": {
          "name": "error_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.games": {
      "name": "games",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "team_id": {
          "name": "team_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "opponent": {
          "name": "opponent",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "game_date": {
          "name": "game_date",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "is_home": {
          "name": "is_home",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "team_score": {
          "name": "team_score",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "opponent_score": {
          "name": "opponent_score",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "is_complete": {
          "name": "is_complete",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "game_stats": {
          "name": "game_stats",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "external_id": {
          "name": "external_id",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_games_team_id": {
          "name": "idx_games_team_id",
          "columns": [
            {
              "expression": "team_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_games_game_date": {
          "name": "idx_games_game_date",
          "columns": [
            {
              "expression": "game_date",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_games_is_complete": {
          "name": "idx_games_is_complete",
          "columns": [
            {
              "expression": "is_complete",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_games_team_date": {
          "name": "idx_games_team_date",
          "columns": [
            {
              "expression": "team_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "game_date",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "games_team_id_teams_id_fk": {
          "name": "games_team_id_teams_id_fk",
          "tableFrom": "games",
          "tableTo": "teams",
          "columnsFrom": [
            "team_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.immutable_evidence": {
      "name": "immutable_evidence",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "evidence_hash": {
          "name": "evidence_hash",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true
        },
        "storage_uri": {
          "name": "storage_uri",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": true
        },
        "canonical_form": {
          "name": "canonical_form",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "stored_at": {
          "name": "stored_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "size_bytes": {
          "name": "size_bytes",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "is_locked": {
          "name": "is_locked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_immutable_evidence_hash": {
          "name": "idx_immutable_evidence_hash",
          "columns": [
            {
              "expression": "evidence_hash",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_immutable_evidence_stored_at": {
          "name": "idx_immutable_evidence_stored_at",
          "columns": [
            {
              "expression": "stored_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "immutable_evidence_evidence_hash_unique": {
          "name": "immutable_evidence_evidence_hash_unique",
          "nullsNotDistinct": false,
          "columns": [
            "evidence_hash"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.leagues": {
      "name": "leagues",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "abbreviation": {
          "name": "abbreviation",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": true
        },
        "api_provider": {
          "name": "api_provider",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "leagues_abbreviation_unique": {
          "name": "leagues_abbreviation_unique",
          "nullsNotDistinct": false,
          "columns": [
            "abbreviation"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.promotion_trigger_events": {
      "name": "promotion_trigger_events",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "promotion_id": {
          "name": "promotion_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "external_event_id": {
          "name": "external_event_id",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "occurred_at": {
          "name": "occurred_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "redeem_window_start_at": {
          "name": "redeem_window_start_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "redeem_window_end_at": {
          "name": "redeem_window_end_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "evidence": {
          "name": "evidence",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_trigger_events_promotion": {
          "name": "idx_trigger_events_promotion",
          "columns": [
            {
              "expression": "promotion_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_trigger_events_window": {
          "name": "idx_trigger_events_window",
          "columns": [
            {
              "expression": "redeem_window_end_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_trigger_events_external": {
          "name": "idx_trigger_events_external",
          "columns": [
            {
              "expression": "external_event_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_trigger_events_unique": {
          "name": "idx_trigger_events_unique",
          "columns": [
            {
              "expression": "promotion_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "external_event_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "promotion_trigger_events_promotion_id_promotions_id_fk": {
          "name": "promotion_trigger_events_promotion_id_promotions_id_fk",
          "tableFrom": "promotion_trigger_events",
          "tableTo": "promotions",
          "columnsFrom": [
            "promotion_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.promotions": {
      "name": "promotions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "team_id": {
          "name": "team_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "restaurant_id": {
          "name": "restaurant_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "title": {
          "name": "title",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "offer_value": {
          "name": "offer_value",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "trigger_condition": {
          "name": "trigger_condition",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "redemption_instructions": {
          "name": "redemption_instructions",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "promo_code": {
          "name": "promo_code",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "valid_until": {
          "name": "valid_until",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "is_seasonal": {
          "name": "is_seasonal",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "source": {
          "name": "source",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'manual'"
        },
        "discovery_data": {
          "name": "discovery_data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "approval_status": {
          "name": "approval_status",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false,
          "default": "'approved'"
        },
        "approved_by": {
          "name": "approved_by",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "approved_at": {
          "name": "approved_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "state": {
          "name": "state",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false,
          "default": "'approved'"
        },
        "source_fingerprint": {
          "name": "source_fingerprint",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false
        },
        "source_url": {
          "name": "source_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "discovered_site_id": {
          "name": "discovered_site_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "trigger_conditions": {
          "name": "trigger_conditions",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "redemption_details": {
          "name": "redemption_details",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "validation_status": {
          "name": "validation_status",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "validation_data": {
          "name": "validation_data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "notification_data": {
          "name": "notification_data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_promotions_active": {
          "name": "idx_promotions_active",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_promotions_state": {
          "name": "idx_promotions_state",
          "columns": [
            {
              "expression": "state",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_promotions_validation_status": {
          "name": "idx_promotions_validation_status",
          "columns": [
            {
              "expression": "validation_status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "promotions_team_id_teams_id_fk": {
          "name": "promotions_team_id_teams_id_fk",
          "tableFrom": "promotions",
          "tableTo": "teams",
          "columnsFrom": [
            "team_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "promotions_restaurant_id_restaurants_id_fk": {
          "name": "promotions_restaurant_id_restaurants_id_fk",
          "tableFrom": "promotions",
          "tableTo": "restaurants",
          "columnsFrom": [
            "restaurant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "promotions_discovered_site_id_discovered_sites_id_fk": {
          "name": "promotions_discovered_site_id_discovered_sites_id_fk",
          "tableFrom": "promotions",
          "tableTo": "discovered_sites",
          "columnsFrom": [
            "discovered_site_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "promotions_source_fingerprint_unique": {
          "name": "promotions_source_fingerprint_unique",
          "nullsNotDistinct": false,
          "columns": [
            "source_fingerprint"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.restaurants": {
      "name": "restaurants",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "logo_url": {
          "name": "logo_url",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "website": {
          "name": "website",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "app_store_url": {
          "name": "app_store_url",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "play_store_url": {
          "name": "play_store_url",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "primary_color": {
          "name": "primary_color",
          "type": "varchar(7)",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        }
      },
      "indexes": {
        "idx_restaurants_is_active": {
          "name": "idx_restaurants_is_active",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "restaurants_name_unique": {
          "name": "restaurants_name_unique",
          "nullsNotDistinct": false,
          "columns": [
            "name"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.search_terms": {
      "name": "search_terms",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "restaurant_id": {
          "name": "restaurant_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "team_id": {
          "name": "team_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "term": {
          "name": "term",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "category": {
          "name": "category",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "success_rate": {
          "name": "success_rate",
          "type": "numeric(3, 2)",
          "primaryKey": false,
          "notNull": false,
          "default": "'0.00'"
        },
        "usage_count": {
          "name": "usage_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "last_used": {
          "name": "last_used",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "search_terms_restaurant_id_restaurants_id_fk": {
          "name": "search_terms_restaurant_id_restaurants_id_fk",
          "tableFrom": "search_terms",
          "tableTo": "restaurants",
          "columnsFrom": [
            "restaurant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "search_terms_team_id_teams_id_fk": {
          "name": "search_terms_team_id_teams_id_fk",
          "tableFrom": "search_terms",
          "tableTo": "teams",
          "columnsFrom": [
            "team_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.sessions": {
      "name": "sessions",
      "schema": "",
      "columns": {
        "sid": {
          "name": "sid",
          "type": "varchar",
          "primaryKey": true,
          "notNull": true
        },
        "sess": {
          "name": "sess",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "expire": {
          "name": "expire",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {
        "IDX_session_expire": {
          "name": "IDX_session_expire",
          "columns": [
            {
              "expression": "expire",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.teams": {
      "name": "teams",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "abbreviation": {
          "name": "abbreviation",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": true
        },
        "city": {
          "name": "city",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "league_id": {
          "name": "league_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "external_id": {
          "name": "external_id",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "logo_url": {
          "name": "logo_url",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "primary_color": {
          "name": "primary_color",
          "type": "varchar(7)",
          "primaryKey": false,
          "notNull": false
        },
        "sport": {
          "name": "sport",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": true
        },
        "conference": {
          "name": "conference",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "division": {
          "name": "division",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_teams_is_active": {
          "name": "idx_teams_is_active",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_teams_league_id": {
          "name": "idx_teams_league_id",
          "columns": [
            {
              "expression": "league_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_teams_sport": {
          "name": "idx_teams_sport",
          "columns": [
            {
              "expression": "sport",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "teams_league_id_leagues_id_fk": {
          "name": "teams_league_id_leagues_id_fk",
          "tableFrom": "teams",
          "tableTo": "leagues",
          "columnsFrom": [
            "league_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "teams_external_id_unique": {
          "name": "teams_external_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "external_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.triggered_deals": {
      "name": "triggered_deals",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "promotion_id": {
          "name": "promotion_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "deal_page_id": {
          "name": "deal_page_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "game_id": {
          "name": "game_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "triggered_at": {
          "name": "triggered_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        }
      },
      "indexes": {
        "idx_triggered_deals_is_active": {
          "name": "idx_triggered_deals_is_active",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_triggered_deals_triggered_at": {
          "name": "idx_triggered_deals_triggered_at",
          "columns": [
            {
              "expression": "triggered_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_triggered_deals_promotion_id": {
          "name": "idx_triggered_deals_promotion_id",
          "columns": [
            {
              "expression": "promotion_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_triggered_deals_game_id": {
          "name": "idx_triggered_deals_game_id",
          "columns": [
            {
              "expression": "game_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_triggered_deals_active_triggered": {
          "name": "idx_triggered_deals_active_triggered",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "triggered_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "triggered_deals_promotion_id_promotions_id_fk": {
          "name": "triggered_deals_promotion_id_promotions_id_fk",
          "tableFrom": "triggered_deals",
          "tableTo": "promotions",
          "columnsFrom": [
            "promotion_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "triggered_deals_deal_page_id_deal_pages_id_fk": {
          "name": "triggered_deals_deal_page_id_deal_pages_id_fk",
          "tableFrom": "triggered_deals",
          "tableTo": "deal_pages",
          "columnsFrom": [
            "deal_page_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "triggered_deals_game_id_games_id_fk": {
          "name": "triggered_deals_game_id_games_id_fk",
          "tableFrom": "triggered_deals",
          "tableTo": "games",
          "columnsFrom": [
            "game_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.users": {
      "name": "users",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar",
          "primaryKey": true,
          "notNull": true
        },
        "email": {
          "name": "email",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "first_name": {
          "name": "first_name",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "last_name": {
          "name": "last_name",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "profile_image_url": {
          "name": "profile_image_url",
          "type": "varchar",
          "primaryKey": false,
          "notNull": false
        },
        "city": {
          "name": "city",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "zip_code": {
          "name": "zip_code",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": false
        },
        "phone_number": {
          "name": "phone_number",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false
        },
        "role": {
          "name": "role",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false,
          "default": "'user'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "users_email_unique": {
          "name": "users_email_unique",
          "nullsNotDistinct": false,
          "columns": [
            "email"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {},
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}